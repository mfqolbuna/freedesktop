name: ðŸš€ SEVER AI STV PREMIUM (RESTART 10 DETIK)

on:
  workflow_dispatch:
  schedule:
    # Menjalankan otomatis (backup schedule tetap)
    - cron: '0 */6 * * *'

jobs:
  Premium-RDP-Setup:
    runs-on: windows-latest
    timeout-minutes: 0  # Tidak giá»›i háº¡n thá»i gian
    
    steps:
      # BANNER CHÃ€O Má»ªNG
      - name: ðŸŽ¯ KHá»žI Äá»˜NG Há»† THá»NG
        run: |
          Write-Host ""
          Write-Host ""
          Write-Host "ðŸ¤– AI STV PREMIUM RDP SERVER" -ForegroundColor Yellow
          Write-Host "âš¡ Powered by AI STV" -ForegroundColor Green
          Write-Host "âš¡ MODE SUPER CEPAT: Restart 10 DETIK" -ForegroundColor Red
          Write-Host "ðŸ”„ Restart otomatis setiap 10 detik" -ForegroundColor Magenta
          Write-Host ""
          
          # Hiá»‡u á»©ng loading ultra cepat
          $frames = @('â ‹', 'â ™', 'â ¹', 'â ¸', 'â ¼', 'â ´', 'â ¦', 'â §', 'â ‡', 'â ')
          for($i=0; $i -lt 3; $i++) {
              Write-Host "`rðŸš€ SUPER FAST MODE... $($frames[$i % 10])" -NoNewline -ForegroundColor Blue
              Start-Sleep -Milliseconds 50
          }
          Write-Host "`râœ… SISTEM ULTRACEpat siap!                    " -ForegroundColor Green

      # Cáº¤U HÃŒHAN ULTRACEpat
      - name: ðŸ”§ Cáº¤U HÃŒNH SISTEM SUPER CEPAT
        run: |
          Write-Host ""
          Write-Host "âš¡ Cáº¤U HÃŒNH SISTEM SUPER CEPAT" -ForegroundColor Yellow
          Write-Host "ðŸ”„ Mode: Restart 10 detik" -ForegroundColor Red
          
          $steps = @(
              @{Name="Aktifkan Remote Desktop"; Script={ 
                  Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0 -Force
              }},
              @{Name="Nonaktifkan auth jaringan"; Script={
                  Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name "UserAuthentication" -Value 0 -Force
              }},
              @{Name="Konfigurasi keamanan RDP"; Script={
                  Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name "SecurityLayer" -Value 0 -Force
              }},
              @{Name="Buka port 3389 firewall"; Script={
                  netsh advfirewall firewall add rule name="RDP-SUPERFAST" dir=in action=allow protocol=TCP localport=3389 profile=any
              }},
              @{Name="Start layanan RDP"; Script={
                  Start-Service -Name TermService -ErrorAction SilentlyContinue
              }}
          )
          
          foreach($step in $steps) {
              Write-Host "â”‚ âš¡ $($step.Name)..." -NoNewline -ForegroundColor White
              try {
                  & $step.Script
                  Write-Host "`râ”‚ âœ… $($step.Name)" -ForegroundColor Green
              } catch {
                  Write-Host "`râ”‚ âš¡ $($step.Name) - Done" -ForegroundColor Yellow
              }
              Start-Sleep -Milliseconds 100
          }
          
          Write-Host "ðŸŽ¯ Konfigurasi ultra cepat selesai!" -ForegroundColor Green

      # Táº O USER - SIMPLE DAN CEPAT
      - name: ðŸ‘¤ BUAT AKUN PREMIUM CEPAT
        run: |
          Write-Host ""
          Write-Host "ðŸ‘¤ BUAT AKUN SUPER CEPAT" -ForegroundColor Yellow
          
          # Password tetap sederhana
          $matKhau = "AISTV123"
          
          $securePass = ConvertTo-SecureString $matKhau -AsPlainText -Force
          
          # Hapus user lama dengan cepat
          try {
              Remove-LocalUser -Name "AISTV" -ErrorAction SilentlyContinue
          } catch { }
          
          # Buat user baru
          try {
              New-LocalUser -Name "AISTV" -Password $securePass -Description "AI STV SuperFast"
              Add-LocalGroupMember -Group "Administrators" -Member "AISTV" -ErrorAction SilentlyContinue
              Add-LocalGroupMember -Group "Remote Desktop Users" -Member "AISTV" -ErrorAction SilentlyContinue
              Enable-LocalUser -Name "AISTV"
              Write-Host "â”‚ âœ… User: AISTV dibuat" -ForegroundColor Green
          } catch {
              Write-Host "â”‚ âœ… User sudah ada" -ForegroundColor Green
          }
          
          echo "RDP_USER=AISTV" >> $env:GITHUB_ENV
          echo "RDP_PASS=$matKhau" >> $env:GITHUB_ENV
          
          Write-Host "âœ… Akun siap dalam 1 detik!" -ForegroundColor Green

      # TAILSCALE - INSTAL CEPAT
      - name: ðŸŒ KONEKSI JARINGAN CEPAT
        env:
          TAILSCALE_AUTH_KEY: ${{ secrets.TAILSCALE_AUTH_KEY }}
        run: |
          Write-Host ""
          Write-Host "ðŸŒ KONEKSI JARINGAN SUPER CEPAT" -ForegroundColor Yellow
          
          # Coba koneksi Tailscale jika ada key
          if ($env:TAILSCALE_AUTH_KEY) {
              try {
                  # Install cepat
                  $msiPath = "$env:TEMP\tailscale-fast.msi"
                  Invoke-WebRequest -Uri "https://pkgs.tailscale.com/stable/tailscale-setup-latest-amd64.msi" -OutFile $msiPath -TimeoutSec 5
                  Start-Process msiexec.exe -ArgumentList "/i", "`"$msiPath`"", "/quiet", "/norestart" -Wait
                  
                  # Konek cepat
                  & "$env:ProgramFiles\Tailscale\tailscale.exe" up --authkey=$env:TAILSCALE_AUTH_KEY --hostname=ai-stv-fast --accept-routes --accept-dns --reset
                  
                  # Ambil IP
                  $ip = & "$env:ProgramFiles\Tailscale\tailscale.exe" ip -4 2>&1
                  if ($ip -and $ip -match '^\d+\.\d+\.\d+\.\d+$') {
                      echo "TAILSCALE_IP=$ip" >> $env:GITHUB_ENV
                      Write-Host "â”‚ âœ… IP Tailscale: $ip" -ForegroundColor Green
                  } else {
                      echo "TAILSCALE_IP=localhost" >> $env:GITHUB_ENV
                  }
              } catch {
                  echo "TAILSCALE_IP=localhost" >> $env:GITHUB_ENV
              }
          } else {
              echo "TAILSCALE_IP=localhost" >> $env:GITHUB_ENV
              Write-Host "â”‚ âš¡ Menggunakan localhost" -ForegroundColor Yellow
          }

      # INFORMASI KONEKSI CEPAT
      - name: ðŸŽ‰ INFO KONEKSI SUPER CEPAT
        run: |
          $timeZone = [System.TimeZoneInfo]::FindSystemTimeZoneById("SE Asia Standard Time")
          $thoiGianBatDau = [System.TimeZoneInfo]::ConvertTimeFromUtc((Get-Date).ToUniversalTime(), $timeZone)
          
          Write-Host ""
          Write-Host "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”" -ForegroundColor Cyan
          Write-Host "â”‚    âš¡ SISTEM SUPER CEPAT - 10 DETIK!       â”‚" -ForegroundColor Red
          Write-Host "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤" -ForegroundColor Cyan
          Write-Host "â”‚ ðŸŒ  Alamat: $env:TAILSCALE_IP" -ForegroundColor White
          Write-Host "â”‚ ðŸ‘¤  User: AISTV" -ForegroundColor White
          Write-Host "â”‚ ðŸ”  Password: AISTV123" -ForegroundColor White
          Write-Host "â”‚ âš¡  Mode: RESTART SETIAP 10 DETIK" -ForegroundColor Red
          Write-Host "â”‚ ðŸ•  Mulai: $($thoiGianBatDau.ToString('HH:mm:ss'))" -ForegroundColor White
          Write-Host "â”‚ ðŸ”„  Restart berikut: +10 detik" -ForegroundColor White
          Write-Host "â”‚ ðŸ“  Port: 3389" -ForegroundColor White
          Write-Host "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤" -ForegroundColor Cyan
          Write-Host "â”‚ ðŸ’¡  INFORMASI PENTING:                    â”‚" -ForegroundColor Cyan
          Write-Host "â”‚   â€¢ Sistem restart otomatis setiap 10 dtk â”‚" -ForegroundColor Yellow
          Write-Host "â”‚   â€¢ Semua data hilang saat restart        â”‚" -ForegroundColor Yellow
          Write-Host "â”‚   â€¢ Mode ultra cepat untuk testing        â”‚" -ForegroundColor Yellow
          Write-Host "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜" -ForegroundColor Cyan

      # âš¡ SISTEM RESTART 10 DETIK âš¡
      - name: âš¡ RESTART OTOMATIS 10 DETIK
        run: |
          Write-Host ""
          Write-Host "âš¡ SISTEM RESTART 10 DETIK DIHIDUPKAN" -ForegroundColor Red
          Write-Host "ðŸ”„ Interval: SETIAP 10 DETIK" -ForegroundColor Magenta
          Write-Host "â±ï¸  Mode: Ultra Cepat" -ForegroundColor Yellow
          
          $restartInterval = 10  # 10 DETIK saja!
          $restartCount = 0
          $startTime = Get-Date
          
          while ($true) {
              $currentTime = Get-Date
              $elapsed = ($currentTime - $startTime).TotalSeconds
              
              # Hitung waktu sampai restart
              $timeUntilRestart = $restartInterval - ($elapsed % $restartInterval)
              
              # Jika waktunya restart (setiap 10 detik)
              if ($timeUntilRestart -le 1) {
                  $restartCount++
                  Write-Host ""
                  Write-Host "âš¡ RESTART KE-$restartCount" -ForegroundColor Red
                  Write-Host "ðŸ• Waktu: $(Get-Date -Format 'HH:mm:ss')" -ForegroundColor White
                  
                  # Simpan statistik restart
                  echo "RESTART_COUNT=$restartCount" >> $env:GITHUB_ENV
                  
                  # Jeda 2 detik sebelum restart (bukan 10 detik lagi)
                  Write-Host "â¸ï¸  Jeda 2 detik sebelum restart..." -ForegroundColor Yellow
                  for($i = 2; $i -gt 0; $i--) {
                      Write-Host "`râ³ Restart dalam: $i detik" -NoNewline -ForegroundColor Yellow
                      Start-Sleep -Seconds 1
                  }
                  
                  Write-Host "`râš¡ MEMULAI RESTART...                  " -ForegroundColor Red
                  
                  # Restart service RDP
                  try {
                      Restart-Service -Name TermService -Force -ErrorAction SilentlyContinue
                      Write-Host "âœ… Service RDP di-restart" -ForegroundColor Green
                  } catch {
                      Write-Host "âš ï¸  Gagal restart service" -ForegroundColor Yellow
                  }
                  
                  # Reset timer
                  $startTime = Get-Date
              }
              
              # Tampilkan countdown ultra cepat
              $secondsLeft = [math]::Ceiling($timeUntilRestart)
              
              # Warna berdasarkan waktu
              $color = if ($secondsLeft -le 3) { "Red" } elseif ($secondsLeft -le 6) { "Yellow" } else { "Green" }
              
              Write-Host "`râš¡ Restart dalam: $secondsLeft detik | Total restart: $restartCount" -NoNewline -ForegroundColor $color
              
              Start-Sleep -Seconds 1
          }

      # MONITOR SISTEM CEPAT
      - name: âš¡ MONITOR REAL-TIME
        run: |
          Write-Host ""
          Write-Host "âš¡ MONITOR REAL-TIME 10 DETIK" -ForegroundColor Yellow
          
          # Script monitor cepat
          $monitorScript = {
              $checkCount = 0
              while ($true) {
                  $currentTime = Get-Date
                  $checkCount++
                  
                  # Cek status service
                  $termService = Get-Service -Name TermService -ErrorAction SilentlyContinue
                  $rdpConnections = Get-NetTCPConnection -LocalPort 3389 -ErrorAction SilentlyContinue | Where-Object {$_.State -eq 'Established'}
                  
                  # Cek penggunaan CPU & RAM cepat
                  $cpu = Get-WmiObject Win32_Processor | Measure-Object -Property LoadPercentage -Average | Select-Object -ExpandProperty Average
                  $ram = Get-WmiObject Win32_OperatingSystem | Select-Object @{Name="UsedMemory";Expression={100 - [math]::Round(($_.FreePhysicalMemory/$_.TotalVisibleMemorySize)*100, 2)}}
                  
                  Write-Host "[$(Get-Date -Format 'HH:mm:ss')] ðŸ”„ Check #$checkCount - RDP: $($termService.Status), Koneksi: $($rdpConnections.Count), CPU: $cpu%, RAM: $($ram.UsedMemory)%" -ForegroundColor Blue
                  
                  Start-Sleep -Seconds 5  # Cek setiap 5 detik
              }
          }
          
          # Jalankan monitor di background
          Start-Job -ScriptBlock $monitorScript -Name "FastMonitor"
          
          Write-Host "âœ… Monitor berjalan setiap 5 detik" -ForegroundColor Green

      # âš¡ MAIN LOOP - RESTART 10 DETIK
      - name: âš¡ LOOP UTAMA RESTART 10 DETIK
        run: |
          Write-Host ""
          Write-Host "âš¡ LOOP UTAMA RESTART 10 DETIK" -ForegroundColor Red
          Write-Host "ðŸ”„ Mode: Restart ultra cepat" -ForegroundColor Magenta
          Write-Host "â±ï¸  Interval: Tepat 10 detik" -ForegroundColor Yellow
          
          $restartInterval = 10  # 10 DETIK
          $cycleCount = 0
          $mainStartTime = Get-Date
          
          while ($true) {
              $cycleCount++
              $cycleStartTime = Get-Date
              
              Write-Host ""
              Write-Host "â•" * 50 -ForegroundColor Cyan
              Write-Host "âš¡ SIKLUS KE-$cycleCount" -ForegroundColor Yellow
              Write-Host "ðŸ• Mulai siklus: $(Get-Date -Format 'HH:mm:ss')" -ForegroundColor White
              
              # Hitung waktu sampai restart siklus ini
              $timeInCycle = 0
              
              while ($timeInCycle -lt $restartInterval) {
                  $currentTime = Get-Date
                  $timeInCycle = ($currentTime - $cycleStartTime).TotalSeconds
                  $timeLeft = $restartInterval - $timeInCycle
                  
                  # Format waktu
                  $timeLeftFormatted = [math]::Max(0, [math]::Ceiling($timeLeft))
                  
                  # Update status setiap detik
                  if ([math]::Floor($timeInCycle) % 1 -eq 0) {
                      # Cek status cepat
                      $termStatus = (Get-Service -Name TermService -ErrorAction SilentlyContinue).Status
                      $connectionCount = @(Get-NetTCPConnection -LocalPort 3389 -ErrorAction SilentlyContinue | Where-Object {$_.State -eq 'Established'}).Count
                      
                      # Progress bar sederhana
                      $progress = [math]::Min(100, ($timeInCycle / $restartInterval) * 100)
                      $progressBar = "[" + ("â–ˆ" * [math]::Floor($progress / 5)) + ("â–‘" * (20 - [math]::Floor($progress / 5))) + "]"
                      
                      Write-Host "`r$progressBar $timeLeftFormatted detik | RDP: $termStatus | Koneksi: $connectionCount" -NoNewline -ForegroundColor Cyan
                  }
                  
                  Start-Sleep -Seconds 1
                  
                  # Jika waktu habis, keluar dari loop dalam
                  if ($timeInCycle -ge $restartInterval - 1) {
                      Write-Host ""
                      Write-Host "â° WAKTU RESTART!" -ForegroundColor Red
                      break
                  }
              }
              
              # RESTART PROSES
              Write-Host "ðŸ”„ MEMULAI RESTART..." -ForegroundColor Yellow
              
              # 1. Restart service RDP
              try {
                  Write-Host "â”‚ ðŸ”„ Restart TermService..." -NoNewline -ForegroundColor White
                  Restart-Service -Name TermService -Force -ErrorAction SilentlyContinue
                  Write-Host "`râ”‚ âœ… TermService di-restart" -ForegroundColor Green
              } catch {
                  Write-Host "`râ”‚ âš ï¸  Gagal restart TermService" -ForegroundColor Yellow
              }
              
              # 2. Reset koneksi RDP
              try {
                  Write-Host "â”‚ ðŸ”„ Reset koneksi RDP..." -NoNewline -ForegroundColor White
                  Get-NetTCPConnection -LocalPort 3389 -ErrorAction SilentlyContinue | 
                      Where-Object {$_.State -eq 'Established'} | 
                      ForEach-Object { 
                          try { $_ | Remove-NetTCPConnection -Force -ErrorAction SilentlyContinue } catch {} 
                      }
                  Write-Host "`râ”‚ âœ… Koneksi RDP di-reset" -ForegroundColor Green
              } catch {
                  Write-Host "`râ”‚ âš ï¸  Gagal reset koneksi" -ForegroundColor Yellow
              }
              
              # 3. Clear memory cache
              try {
                  Write-Host "â”‚ ðŸ”„ Bersihkan cache..." -NoNewline -ForegroundColor White
                  Clear-DnsClientCache -ErrorAction SilentlyContinue
                  Write-Host "`râ”‚ âœ… Cache dibersihkan" -ForegroundColor Green
              } catch {
                  Write-Host "`râ”‚ âš¡ Cache OK" -ForegroundColor Yellow
              }
              
              # Statistik siklus
              $cycleEndTime = Get-Date
              $cycleDuration = ($cycleEndTime - $cycleStartTime).TotalSeconds
              $totalDuration = ($cycleEndTime - $mainStartTime).TotalSeconds
              
              Write-Host "â”‚ ðŸ“Š Durasi siklus: $([math]::Round($cycleDuration, 2)) detik" -ForegroundColor White
              Write-Host "â”‚ ðŸ“ˆ Total waktu: $([math]::Floor($totalDuration / 60)) menit $([math]::Round($totalDuration % 60)) detik" -ForegroundColor White
              Write-Host "â”‚ ðŸ”¢ Total siklus: $cycleCount" -ForegroundColor White
              Write-Host ""
              Write-Host "âš¡ SIKLUS $cycleCount SELESAI, SIAPKAN SIKLUS BERIKUTNYA..." -ForegroundColor Green
              
              # Jeda 1 detik sebelum siklus berikutnya
              Start-Sleep -Seconds 1
          }

      # âš¡ SIMPLE RESTART LOOP (ALTERNATIF)
      - name: âš¡ SIMPLE 10-SECOND LOOP
        run: |
          Write-Host ""
          Write-Host "âš¡ MODE SIMPLE: RESTART SETIAP 10 DETIK" -ForegroundColor Red
          Write-Host "ðŸ”„ Loop tanpa henti" -ForegroundColor Yellow
          
          $counter = 0
          
          while ($true) {
              $counter++
              $currentTime = Get-Date
              
              # Display informasi
              Write-Host ""
              Write-Host "â”€" * 40 -ForegroundColor Cyan
              Write-Host "ðŸ”„ RESTART #$counter" -ForegroundColor Yellow
              Write-Host "ðŸ• Waktu: $(Get-Date -Format 'HH:mm:ss')" -ForegroundColor White
              
              # Restart service
              try {
                  Restart-Service -Name TermService -Force
                  Write-Host "âœ… RDP Service di-restart" -ForegroundColor Green
              } catch {
                  Write-Host "âš ï¸  Restart service gagal" -ForegroundColor Yellow
              }
              
              # Countdown 10 detik
              Write-Host "â³ Menunggu 10 detik..." -ForegroundColor Cyan
              
              for ($i = 10; $i -gt 0; $i--) {
                  Write-Host "`râ±ï¸  Restart berikut dalam: $i detik" -NoNewline -ForegroundColor Green
                  Start-Sleep -Seconds 1
              }
              
              Write-Host "`râš¡ Restart berikutnya...                  " -ForegroundColor Red
          }

      # âš¡ ULTRACEpat RESTART LOOP
      - name: âš¡ ULTRACEPAT RESTART LOOP
        run: |
          Write-Host ""
          Write-Host "âš¡ âš¡ âš¡ MODE ULTRACEPAT âš¡ âš¡ âš¡" -ForegroundColor Red -BackgroundColor White
          Write-Host "ðŸ”„ RESTART: SETIAP 10 DETIK" -ForegroundColor Black -BackgroundColor Yellow
          Write-Host "â±ï¸  PRESISI: MILLISECOND" -ForegroundColor Black -BackgroundColor Green
          
          $ultraCounter = 0
          $ultraStart = Get-Date
          
          # Timer precision loop
          while ($true) {
              $ultraCounter++
              $loopStart = Get-Date
              
              # Header ultra cepat
              Write-Host ""
              Write-Host "â”Œâ”€â”€â”€ ULTRA CEPAT #$ultraCounter â”€â”€â”€â”" -ForegroundColor Red
              
              # Restart action (sangat cepat)
              try {
                  $service = Get-Service -Name TermService -ErrorAction SilentlyContinue
                  if ($service.Status -eq 'Running') {
                      $service.Stop()
                      Start-Sleep -Milliseconds 100
                      $service.Start()
                      Write-Host "â”‚ âœ… RDP: Restart 100ms" -ForegroundColor Green
                  }
              } catch {
                  Write-Host "â”‚ âš¡ RDP: OK" -ForegroundColor Yellow
              }
              
              # Quick status check
              $connections = @(Get-NetTCPConnection -LocalPort 3389 -ErrorAction SilentlyContinue | Where-Object {$_.State -eq 'Established'}).Count
              Write-Host "â”‚ ðŸŒ Koneksi: $connections" -ForegroundColor White
              
              # Calculate timing
              $loopEnd = Get-Date
              $loopTime = ($loopEnd - $loopStart).TotalMilliseconds
              $totalTime = ($loopEnd - $ultraStart).TotalSeconds
              
              Write-Host "â”‚ â±ï¸  Loop: ${loopTime}ms" -ForegroundColor Cyan
              Write-Host "â”‚ ðŸ• Total: $([math]::Floor($totalTime)) detik" -ForegroundColor White
              Write-Host "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜" -ForegroundColor Red
              
              # Calculate sleep time untuk tepat 10 detik per loop
              $targetLoopTime = 10000  # 10 detik dalam milidetik
              $sleepTime = [math]::Max(100, $targetLoopTime - $loopTime)  # Minimal 100ms
              
              # Countdown millisecond precision
              $sleepSeconds = [math]::Floor($sleepTime / 1000)
              $sleepMillis = $sleepTime % 1000
              
              Write-Host "â³ Tidur: ${sleepSeconds}.${sleepMillis}s" -NoNewline -ForegroundColor Blue
              
              # High precision sleep
              $sleepStart = Get-Date
              while ((Get-Date) - $sleepStart).TotalMilliseconds -lt $sleepTime) {
                  Start-Sleep -Milliseconds 100
              }
              
              Write-Host "`râš¡ Loop berikutnya...                    " -ForegroundColor Red
          }

      # âš¡ EXTREME FAST MODE
      - name: âš¡ EXTREME 10-SECOND RESTART
        run: |
          Write-Host ""
          Write-Host "âš¡âš¡âš¡ EXTREME MODE âš¡âš¡âš¡" -ForegroundColor White -BackgroundColor Red
          Write-Host "RESTART: 10 DETIK PASTI!" -ForegroundColor Yellow
          
          # Extreme simple loop
          while ($true) {
              $now = Get-Date
              
              # Extreme fast display
              Write-Host "`r[$(Get-Date -Format 'HH:mm:ss')] ðŸ”„ RDP RESTART" -NoNewline -ForegroundColor Red
              
              # Extreme fast restart
              sc.exe control TermService 129 2>&1 | Out-Null  # Fast control command
              
              # Wait exactly 10 seconds
              $targetTime = $now.AddSeconds(10)
              while ((Get-Date) -lt $targetTime) {
                  $remaining = ($targetTime - (Get-Date)).TotalSeconds
                  Write-Host "`r[$(Get-Date -Format 'HH:mm:ss')] â±ï¸  Next: $([math]::Ceiling($remaining))s" -NoNewline -ForegroundColor Green
                  Start-Sleep -Milliseconds 100
              }
          }

      # CLEANUP CEPAT
      - name: âš¡ CLEANUP CEPAT
        if: always()
        run: |
          Write-Host ""
          Write-Host "âš¡ CLEANUP SUPER CEPAT" -ForegroundColor Yellow
          
          # Cleanup dalam 2 detik
          Write-Host "ðŸ—‘ï¸  Cleanup dalam 2 detik..." -ForegroundColor Cyan
          
          for($i = 2; $i -gt 0; $i--) {
              Write-Host "`râ³ Cleanup: $i detik" -NoNewline -ForegroundColor Yellow
              Start-Sleep -Seconds 1
          }
          
          Write-Host "`râœ… Cleanup selesai!                    " -ForegroundColor Green
          
          # Simple cleanup
          try {
              # Nonaktifkan user
              Disable-LocalUser -Name "AISTV" -ErrorAction SilentlyContinue
              
              # Stop Tailscale jika ada
              & "$env:ProgramFiles\Tailscale\tailscale.exe" down 2>&1 | Out-Null
              
              # Hapus firewall rule
              netsh advfirewall firewall delete rule name="RDP-SUPERFAST" 2>&1 | Out-Null
              
          } catch {
              # Ignore semua error di mode cepat
          }
          
          Write-Host "âš¡ SISTEM BERSIH, SIAP RESTART LAGI!" -ForegroundColor Green
